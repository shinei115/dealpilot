<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DealPilot - 최고의 제품, 최고의 딜</title>
    <style>
      body {
        font-family: sans-serif;
        background-color: #f8f9fa;
        margin: 0;
        padding: 0;
      }
      header {
        background-color: #222;
        color: #fff;
        padding: 1rem;
        text-align: center;
      }
      .container {
        max-width: 800px;
        margin: 2rem auto;
        padding: 1rem;
      }
      .search-box {
        display: flex;
        margin-bottom: 2rem;
      }
      .search-box input {
        flex: 1;
        padding: 0.75rem;
        font-size: 1rem;
        border: 1px solid #ccc;
        border-radius: 4px 0 0 4px;
      }
      .search-box button {
        padding: 0.75rem 1rem;
        font-size: 1rem;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 0 4px 4px 0;
        cursor: pointer;
        min-width: 80px;
        touch-action: manipulation;
      }
      .card {
        background: white;
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 1rem;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        transition: all 0.3s ease-in-out;
        justify-content: space-between;
        flex-wrap: wrap; /* 줄바꿈 필요 시 */
      }
      .card:hover {
        transform: scale(1.02);
      }
      .card img {
        width: 80px;
        height: 80px;
        object-fit: cover;
        border-radius: 6px;
        margin-right: 1rem;
      }
      .card-content {
        flex: 1; /* 남은 공간 차지 */
      }
      .card-content h2 {
        font-size: 1.1rem;
        margin: 0 0 0.3rem 0;
      }
      .card-content p {
        font-size: 0.9rem;
        margin: 0 0 0.5rem 0;
        color: #333;
      }
      .card-content a {
        margin-left: auto;
        padding: 0.5rem 1rem;
        text-decoration: none;
        color: white;
        background-color: #007bff;
        font-size: 1rem;
        font-weight: bold;
        border-radius: 8px;
        white-space: nowrap;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        position: relative;
        overflow: hidden;
        animation: glow-border 1.5s infinite alternate ease-in-out;
        transition: transform 0.2s ease;
      }
      .card-content a:hover {
        transform: scale(1.05);
      }
      @keyframes glow-border {
        0% {
          box-shadow: 0 0 3px #007bff, 0 0 2px #007bff;
        }
        100% {
          box-shadow: 0 0 7px #00aaff, 0 0 5px #00aaff;
        }
      }
      footer {
        text-align: center;
        font-size: 0.8rem;
        color: #666;
        padding: 1rem 0;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>🔥 딜파일럿 - DealPilot</h1>
      <h3>최고의 제품만</h3>
    </header>

    <div class="container">
      <div class="search-box">
        <input
          type="text"
          id="searchInput"
          placeholder="예: 여름, 선풍기, 클랜저"
        />
        <button onclick="filterProducts()">검색</button>
      </div>

      <p id="resultInfo" style="font-weight: bold; margin-bottom: 1rem"></p>
      <p id="noResults" style="display: none; color: gray; text-align: center">
        검색 결과가 없습니다 😢
      </p>
      <div class="card">
        <img
          src="https://thumbnail8.coupangcdn.com/thumbnails/remote/492x492ex/image/vendor_inventory/c4b2/c8a2a3971ba794507ce6e6caeaec8c98df9a685002515a57b67488b66990.jpg"
          alt="AI 스마트폰 짐벌"
        />
        <div class="card-content">
          <h2>
            <span class="badge">6번 -</span> 지윤 스무스 5S AI 스마트폰 짐벌
          </h2>
          <p>AI가 알아서 트래킹! 🎯 여행, 브이로그 필수 현존 최강 짐벌</p>
          <a
            href="https://link.coupang.com/a/cJDUmb"
            target="_blank"
            onclick="trackClick('스마트폰 짐벌')"
            >최저가로 구매</a
          >
        </div>
      </div>
      <div class="card">
        <img
          src="https://thumbnail10.coupangcdn.com/thumbnails/remote/492x492ex/image/vendor_inventory/1e35/4ab6116bc908908cca8ea8298b45cff639dee4e0b6ed85ca09ebfaf962f3.jpg"
          alt="전동청소솔 PRO"
        />
        <div class="card-content">
          <h2><span class="badge">5번 -</span> 파빗 2세대 전동청소솔 PRO</h2>
          <p>피부 깊은 곳까지 작용하는 PDRN 앰플 클렌징 2개 세트 구성</p>
          <a
            href="https://link.coupang.com/a/cJr8oP"
            target="_blank"
            onclick="trackClick('전동 청소기')"
            >최저가로 구매</a
          >
        </div>
      </div>

      <div class="card">
        <img
          src="https://thumbnail10.coupangcdn.com/thumbnails/remote/492x492ex/image/vendor_inventory/9caa/45f540d69cee8d292d79e193e64d0926fbd0286173457142c6a23be3db32.jpg"
          alt="메라블 PDRN 루비알엔"
        />
        <div class="card-content">
          <h2>
            <span class="badge">4번 -</span> 기미, 미백 케어 메라블 PDRN
            루비알엔 앰플 클렌저 (150 ml × 2)
          </h2>
          <p>피부 깊은 곳까지 작용하는 PDRN 앰플 클렌징 2개 세트 구성</p>
          <a
            href="https://link.coupang.com/a/cJaNgY"
            target="_blank"
            onclick="trackClick('클랜저')"
            >최저가로 구매</a
          >
        </div>
      </div>

      <div class="card">
        <img
          src="https://thumbnail9.coupangcdn.com/thumbnails/remote/492x492ex/image/retail/images/67038293282094-5706a620-1e6d-40ff-9bb4-30b987febfec.jpg"
          alt="청정원 천일염 구운소금"
        />
        <div class="card-content">
          <h2>
            <span class="badge">3번 -</span> 청정원 천일염 구운소금 1 kg × 2개
            세트
          </h2>
          <p>800도의 정성, 신안의 순수함 – 청정원 천일염 구운소금 2kg</p>
          <a
            href="https://link.coupang.com/a/cJatBh"
            target="_blank"
            onclick="trackClick('구운소금')"
            >최저가로 구매</a
          >
        </div>
      </div>

      <div class="card">
        <img
          src="https://thumbnail8.coupangcdn.com/thumbnails/remote/492x492ex/image/retail/images/862066641797853-b5cd166c-2594-47ae-b324-5a5153f063d3.jpg"
          alt="미니 선풍기"
        />
        <div class="card-content">
          <h2><span class="badge">2번 -</span> 미니 선풍기</h2>
          <p>휴대성, 냉감 최고! 여름철 꿀템 미니 선풍기</p>
          <a
            href="https://link.coupang.com/a/cI9uDm"
            target="_blank"
            onclick="trackClick('미니 선풍기')"
            >최저가로 구매</a
          >
        </div>
      </div>

      <div class="card">
        <img
          src="https://thumbnail7.coupangcdn.com/thumbnails/remote/492x492ex/image/vendor_inventory/fe06/897c591bea86a8e2bddad6c76d85f788597661f7983702f3bb9f78af47cc.jpg"
          alt="쿨링 매트"
        />
        <div class="card-content">
          <h2><span class="badge">1번 -</span> 쿨링 매트</h2>
          <p>시원하게 꿀잠 자자! 여름 필수템 쿨매트</p>
          <a
            href="https://link.coupang.com/a/cI9wQc "
            target="_blank"
            onclick=" trackClick('쿨링 매트')"
            >최저가로 구매</a
          >
        </div>
      </div>
    </div>

    <footer>
      ※ 이 페이지는 쿠팡 파트너스 활동의 일환으로, 이에 따른 일정액의 수수료를
      제공받을 수 있습니다.
    </footer>

    <script>
      function normalizeText(text) {
        return text.toLowerCase().replace(/\s+/g, "").replace(/\./g, "");
      }

      function filterProducts() {
        const keyword = normalizeText(
          document.getElementById("searchInput").value
        );
        const cards = document.querySelectorAll(".card");
        let matchCount = 0;

        cards.forEach((card) => {
          const title = normalizeText(card.querySelector("h2").textContent);
          const desc = normalizeText(card.querySelector("p").textContent);

          if (title.includes(keyword) || desc.includes(keyword)) {
            card.style.display = "flex";
            matchCount++;
          } else {
            card.style.display = "none";
          }
        });

        document.getElementById("noResults").style.display =
          matchCount === 0 ? "block" : "none";
        document.getElementById("resultInfo").textContent = keyword
          ? `‘${
              document.getElementById("searchInput").value
            }’ 검색 결과: ${matchCount}건`
          : "";
      }

      document
        .getElementById("searchInput")
        .addEventListener("input", filterProducts);
      // 세션 생성 및 유지
      function getSessionId() {
        let sessionId = localStorage.getItem("sessionId");
        if (!sessionId) {
          sessionId = "sess_" + Math.random().toString(36).substr(2, 9);
          localStorage.setItem("sessionId", sessionId);
        }
        return sessionId;
      }

      // 클릭 로그 서버 전송
      function trackClick(productName) {
        const logData = {
          sessionId: getSessionId(),
          product: productName,
          timestamp: new Date().toISOString(),
          userAgent: navigator.userAgent,
        };

        fetch("https://dealpilot-server.onrender.com/log", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(logData),
        }).catch((err) => console.error("로그 전송 실패:", err));
      }
    </script>
  </body>
</html>
